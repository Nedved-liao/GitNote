<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>(无标题).html</title>
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
body {
  margin: 15px 18px 15px 18px;
  background-color: #ffffff;
}
/* ========== Text Styles ========== */
hr { color: #000000}
body, table, span.rvts0 /* Normal text */
{
 font-size: 10pt;
 font-family: '宋体';
 font-style: normal;
 font-weight: normal;
 color: #000000;
 text-decoration: none;
}
a.rvts1, span.rvts1 /* Hyperlink */
{
 color: #0000ff;
 text-decoration: underline;
}
span.rvts2
{
 font-size: 12pt;
 font-family: 'Times New Roman', 'Times', serif;
}
span.rvts3
{
 font-size: 12pt;
 font-family: 'Times New Roman', 'Times', serif;
 font-weight: bold;
}
span.rvts4
{
 font-family: 'Courier New', 'Courier', monospace;
}
span.rvts5
{
 font-family: 'Courier New', 'Courier', monospace;
 font-weight: bold;
}
span.rvts6
{
 font-size: 12pt;
 font-weight: bold;
 color: #000000;
}
/* ========== Para Styles ========== */
p,ul,ol /* Paragraph Style */
{
 text-align: left;
 text-indent: 0px;
 padding: 0px 0px 0px 0px;
 margin: 0px 0px 0px 0px;
}
.rvps1 /* Centered */
{
 text-align: center;
}
--></style>
</head>
<body>

<span class=rvts6>2019&#24180;9&#26376;12&#26085; &#21608;&#22235; 14:52</span>

<span class=rvts2>
</span>

<span class=rvts2>Oracle 9i &#24320;&#22987;&#25903;&#25345;&#38378;&#22238;&#65292;Oracle10g&#24320;&#22987;&#20840;&#38754;&#25903;&#25345;&#38378;&#22238;&#21151;&#33021;&#65292;Oracle11g&#26377;&#25152;&#23436;&#21892;&#65292;&#20026;&#22823;&#23478;&#24555;&#36895;&#30340;&#24674;&#22797;&#25968;&#25454;&#65292;&#26597;&#35810;&#21382;&#21490;&#25968;&#25454;&#25552;&#20379;&#20102;&#24456;&#22823;&#30340;&#20415;&#25463;&#26041;&#27861;&#12290;</span>

<span class=rvts2>&#26412;&#25991;&#20027;&#35201;&#23545;Oracle&#24120;&#29992;&#38378;&#22238;&#20351;&#29992;&#20570;&#20123;&#35814;&#32454;&#20171;&#32461;&#65292;&#20854;&#20013;&#23545;&#20110;&#19981;&#24120;&#29992;&#30340;&#20107;&#21153;&#21644;&#29256;&#26412;&#38378;&#22238;&#65292;&#36825;&#37324;&#23601;&#19981;&#20570;&#20171;&#32461;</span>

<span class=rvts3>&#19968;&#12289;Oracle&#38378;&#22238;&#27010;&#36848;</span>

<div><table border=1 cellpadding=1 cellspacing=2 style="border-color: #f0f0f0 #a0a0a0 #a0a0a0 #f0f0f0; border-style: solid; background-color: #eeeeee;">
<tr valign=top>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#38378;&#22238;&#32423;&#21035;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#38378;&#22238;&#22330;&#26223;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#38378;&#22238;&#25216;&#26415;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#23545;&#35937;&#20381;&#36182;&#12288;&#12288;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#24433;&#21709;&#25968;&#25454;</span>

</td>
</tr>
<tr valign=top>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#25968;&#25454;&#24211;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#34920;&#25130;&#26029;&#12289;&#36923;&#36753;&#38169;&#35823;&#12289;&#20854;&#20182;&#22810;&#34920;&#24847;&#22806;&#20107;&#20214;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#38378;&#22238;DATABASE</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#38378;&#22238;&#26085;&#24535;&#12289;undo</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#26159;</span>

</td>
</tr>
<tr valign=top>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>DROP</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#21024;&#38500;&#34920;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#38378;&#22238;DROP</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#22238;&#25910;&#31449;(recyclebin)</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#26159;</span>

</td>
</tr>
<tr valign=top>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#34920;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#26356;&#26032;&#12289;&#21024;&#38500;&#12289;&#25554;&#20837;&#35760;&#24405;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#38378;&#22238;TABLE</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#36824;&#21407;&#25968;&#25454;,undo</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#26159;</span>

</td>
</tr>
<tr valign=top>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#26597;&#35810;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#24403;&#21069;&#25968;&#25454;&#21644;&#21382;&#21490;&#25968;&#25454;&#23545;&#27604;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#38378;&#22238;QUERY</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#36824;&#21407;&#25968;&#25454;,undo</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#21542;</span>

</td>
</tr>
<tr valign=top>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#29256;&#26412;&#26597;&#35810;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#27604;&#36739;&#34892;&#29256;&#26412;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#38378;&#22238;Version Query</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#36824;&#21407;&#25968;&#25454;,undo</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#21542;</span>

</td>
</tr>
<tr valign=top>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#20107;&#21153;&#26597;&#35810;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#27604;&#36739;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#38378;&#22238;Transaction Query</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#36824;&#21407;&#25968;&#25454;,undo</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#21542;</span>

</td>
</tr>
<tr valign=top>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#24402;&#26723;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>DDL&#12289;DML</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#38378;&#22238;Archive</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#24402;&#26723;&#26085;&#24535;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&#26159;</span>

</td>
</tr>
<tr valign=top>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&nbsp;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&nbsp;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&nbsp;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&nbsp;</span>

</td>
<td valign=middle style="border-color : #a0a0a0 #f0f0f0 #f0f0f0 #a0a0a0; border-style: solid;">

<span class=rvts2>&nbsp;</span>

</td>
</tr>
</table>
</div>

<span class=rvts2>&nbsp;</span>

<span class=rvts2>&nbsp;</span>

<span class=rvts2>&nbsp;</span>

<span class=rvts2>&nbsp;</span>

<span class=rvts2>&nbsp;</span>

<span class=rvts2>&nbsp;</span>

<span class=rvts2>&nbsp;</span>

<span class=rvts2>&nbsp;&nbsp;</span>

<span class=rvts2>&nbsp;</span>

<span class=rvts2>&nbsp;</span><span class=rvts3>&#20108;&#12289;Oracle&#38378;&#22238;&#20351;&#29992;&#35814;&#35299;</span>

<span class=rvts3>1&#12289;&#38378;&#22238;&#24320;&#21551;</span>

<span class=rvts3>(1)&#24320;&#21551;&#38378;&#22238;&#24517;&#35201;&#26465;&#20214;</span>

<span class=rvts2>a.&#24320;&#21551;&#24402;&#26723;&#26085;&#24535;</span>

![复制代码]((无标题).files/img1.jpg)

<span class=rvts4>SQL&gt;</span><span class=rvts2> archive log list;
</span>

<span class=rvts2>Database log mode Archive Mode
A</span>

<span class=rvts2>Automatic archival Enabled
A</span>

<span class=rvts2>Archive destination /home/U01/app/oracle/oradata/testdb/arch
O</span>

<span class=rvts2>Oldest online log sequence 844</span>

<span class=rvts2>Next log sequence to archive 846</span>

<span class=rvts2>Current log sequence 846</span>

<span class=rvts2>
#</span>

<span class=rvts2>##&#22914;&#26410;&#24320;&#21551;&#65292;&#22312;mount&#29366;&#24577;&#25191;&#34892;alter database archivelog;</span>

![复制代码]((无标题).files/img2.jpg)

<span class=rvts2>b.&#35774;&#32622;&#21512;&#29702;&#30340;&#38378;&#22238;&#21306;</span>

<span class=rvts2>db_recovery_file_dest&#65306;&#25351;&#23450;&#38378;&#22238;&#24674;&#22797;&#21306;&#30340;&#20301;&#32622;</span>

<span class=rvts2>db_recovery_file_dest_size&#65306;&#25351;&#23450;&#38378;&#22238;&#24674;&#22797;&#21306;&#30340;&#21487;&#29992;&#31354;&#38388;&#22823;&#23567;</span>

<span class=rvts2>db_flashback_retention_target&#65306;&#25351;&#23450;&#25968;&#25454;&#24211;&#21487;&#20197;&#22238;&#36864;&#30340;&#26102;&#38388;&#65292;&#21333;&#20301;&#20026;&#20998;&#38047;&#65292;&#40664;&#35748;1440&#20998;&#38047;(1&#22825;),&#23454;&#38469;&#21462;&#20915;&#20110;&#38378;&#22238;&#21306;&#22823;&#23567;</span>

<span class=rvts3>(2)&#26816;&#26597;&#26159;&#21542;&#24320;&#21551;&#38378;&#22238;</span>

<span class=rvts5>SQL&gt;</span><span class=rvts4> select</span><span class=rvts2> flashback_on from v$database;
F</span>

<span class=rvts2>FLASHBACK_ON
</span>

<span class=rvts2>------------------
N</span>

<span class=rvts2>NO</span>

<span class=rvts3>(3)&#24320;&#21551;&#38378;&#22238;</span>

<span class=rvts2>a.&#24320;&#21551;&#24402;&#26723;</span>

<span class=rvts4>mount&#29366;&#24577;&#65306;alter</span><span class=rvts2> database archivelog;</span>

<span class=rvts2>b.&#35774;&#32622;&#38378;&#22238;&#21306;</span>

<span class=rvts4>SQL&gt;</span><span class=rvts2> alter system set db_recovery_file_dest='/home/U01/app/oracle/fast_recovery_area' scope=both;
S</span>

<span class=rvts2>System altered.
S</span>

<span class=rvts2>SQL&gt; alter system set db_recovery_file_dest_size=60G scope=both;
S</span>

<span class=rvts2>System altered.
S</span>

<span class=rvts2>SQL&gt; alter system set db_flashback_retention_target=4320 scope=both;
S</span>

<span class=rvts2>System altered. &nbsp; &nbsp;</span>

<span class=rvts2>c.&#24320;&#21551;flashback (10g&#22312;mount&#24320;&#21551;)</span>

<span class=rvts4>SQL&gt;</span><span class=rvts2> alter database flashback on;
</span>

<span class=rvts2>Database altered.</span>

<span class=rvts3>(4)&#30830;&#23450;&#38378;&#22238;&#24320;&#21551;</span>

<span class=rvts4>SQL&gt;</span><span class=rvts2> select flashback_on from v$database;
F</span>

<span class=rvts2>FLASHBACK_ON
</span>

<span class=rvts2>------------------
Y</span>

<span class=rvts2>YES &nbsp; &nbsp;</span>

<span class=rvts3>(5)&#20851;&#38381;&#38378;&#22238;</span>

<span class=rvts4>SQL&gt;</span><span class=rvts2> alter database flashback off;
</span>

<span class=rvts2>Database altered.</span>

<span class=rvts3>2&#12289;&#38378;&#22238;&#20351;&#29992;</span>

<span class=rvts3>(1)&#38378;&#22238;&#26597;&#35810;</span>

<span class=rvts2>&#38378;&#22238;&#26597;&#35810;&#20027;&#35201;&#26159;&#26681;&#25454;Undo&#34920;&#31354;&#38388;&#25968;&#25454;&#36827;&#34892;&#22810;&#29256;&#26412;&#26597;&#35810;&#65292;&#38024;&#23545;v$&#21644;x$&#21160;&#24577;&#24615;&#33021;&#35270;&#22270;&#26080;&#25928;&#65292;&#20294;&#23545;DBA_&#12289;ALL_&#12289;USER_&#26159;&#26377;&#25928;&#30340;</span>

<span class=rvts3>a.&#38378;&#22238;&#26597;&#35810;</span>

<span class=rvts2>&#20801;&#35768;&#29992;&#25143;&#26597;&#35810;&#36807;&#21435;&#26576;&#20010;&#26102;&#38388;&#28857;&#30340;&#25968;&#25454;&#65292;&#29992;&#20197;&#37325;&#26500;&#30001;&#20110;&#24847;&#22806;&#21024;&#38500;&#25110;&#26356;&#25913;&#30340;&#25968;&#25454;&#65292;&#25968;&#25454;&#19981;&#20250;&#21464;&#21270;&#12290;</span>

![复制代码]((无标题).files/img3.jpg)

<span class=rvts4>SQL&gt;</span><span class=rvts2> select * from scott.dept;
D</span>

<span class=rvts2>DEPTNO DNAME LOC
</span>

<span class=rvts2>---------- -------------- -------------</span>

<span class=rvts2>10 ACCOUNTING NEW YORK
</span>

<span class=rvts2>20 RESEARCH DALLAS
</span>

<span class=rvts2>30 SALES CHICAGO
</span>

<span class=rvts2>40 OPERATIONS BOSTON
S</span>

<span class=rvts2>SQL&gt; delete from scott.dept where deptno=40;
</span>

<span class=rvts2>1 row deleted.
S</span>

<span class=rvts2>SQL&gt; commit;
</span>

<span class=rvts2>Commit complete.
S</span>

<span class=rvts2>SQL&gt; select * from scott.dept as of timestamp sysdate-10/1440;

</span>

<span class=rvts2>
D</span>

<span class=rvts2>DEPTNO DNAME LOC
</span>

<span class=rvts2>---------- -------------- -------------</span>

<span class=rvts2>10 ACCOUNTING NEW YORK
</span>

<span class=rvts2>20 RESEARCH DALLAS
</span>

<span class=rvts2>30 SALES CHICAGO
</span>

<span class=rvts2>40 OPERATIONS BOSTON
S</span>

<span class=rvts2>SQL&gt; select * from scott.dept as of timestamp to_timestamp('2017-12-14 16:20:00','yyyy-mm-dd hh24:mi:ss');

</span>

<span class=rvts2>
D</span>

<span class=rvts2>DEPTNO DNAME LOC
</span>

<span class=rvts2>---------- -------------- -------------</span>

<span class=rvts2>10 ACCOUNTING NEW YORK
</span>

<span class=rvts2>20 RESEARCH DALLAS
</span>

<span class=rvts2>30 SALES CHICAGO
</span>

<span class=rvts2>40 OPERATIONS BOSTON

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; select * from scott.dept as of scn 16801523;

</span>

<span class=rvts2>
D</span>

<span class=rvts2>DEPTNO DNAME LOC
</span>

<span class=rvts2>---------- -------------- -------------</span>

<span class=rvts2>10 ACCOUNTING NEW YORK
</span>

<span class=rvts2>20 RESEARCH DALLAS
</span>

<span class=rvts2>30 SALES CHICAGO
</span>

<span class=rvts2>40 OPERATIONS BOSTON</span>

![复制代码]((无标题).files/img4.jpg)

<span class=rvts2>b.&#38378;&#22238;&#29256;&#26412;&#26597;&#35810;</span>

<span class=rvts2>&#29992;&#20110;&#26597;&#35810;&#34892;&#32423;&#25968;&#25454;&#24211;&#38543;&#26102;&#38388;&#21464;&#21270;&#30340;&#26041;&#27861;</span>

<span class=rvts2>
</span>

<span class=rvts2>c.&#38378;&#22238;&#20107;&#21153;&#26597;&#35810;</span>

<span class=rvts2>&#29992;&#20110;&#25552;&#20379;&#26597;&#30475;&#20107;&#21153;&#32423;&#21035;&#25968;&#25454;&#24211;&#21464;&#21270;&#30340;&#26041;&#27861;</span>

<span class=rvts2>
</span>

<span class=rvts3>(2)&#38378;&#22238;&#34920;(update/insert/delete)</span>

<span class=rvts2>&#38378;&#22238;&#34920;&#23601;&#26159;&#23545;&#34920;&#30340;&#25968;&#25454;&#20570;&#22238;&#36864;&#65292;&#22238;&#36864;&#21040;&#20043;&#21069;&#30340;&#26576;&#20010;&#26102;&#38388;&#28857;&#65292;&#20854;&#21033;&#29992;&#30340;&#26159;undo&#30340;&#21382;&#21490;&#25968;&#25454;&#65292;&#19982;undo_retention&#35774;&#32622;&#26377;&#20851;&#65292;&#40664;&#35748;&#26159;14400&#20998;&#38047;&#65288;1&#22825;&#65289;</span>

<span class=rvts2>&#21516;&#26679;&#65292;sys&#29992;&#25143;&#34920;&#31354;&#38388;&#19981;&#25903;&#25345;&#38378;&#22238;&#34920;,&#35201;&#24819;&#34920;&#38378;&#22238;&#65292;&#38656;&#35201;&#20801;&#35768;&#34920;&#21551;&#21160;&#34892;&#36801;&#31227;(row movement)</span>

<span class=rvts2>&#38378;&#22238;&#34920;&#31034;&#20363;&#65306;</span>

![复制代码]((无标题).files/img5.jpg)

<span class=rvts4>SQL&gt;</span><span class=rvts2> flashback table scott.dept to timestamp to_timestamp('2017-12-14 16:20:00','yyyy-mm-dd hh24:mi:ss');
f</span>

<span class=rvts2>flashback table scott.dept to timestamp to_timestamp('2017-12-14 16:20:00','yyyy-mm-dd hh24:mi:ss')
E</span>

<span class=rvts2>ERROR at line 1:
O</span>

<span class=rvts2>ORA-08189: cannot flashback the table because row movement is not enabled

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; select row_movement from dba_tables where table_name='DEPT' and owner='SCOTT';
R</span>

<span class=rvts2>ROW_MOVE
</span>

<span class=rvts2>--------</span>

<span class=rvts2>DISABLED
S</span>

<span class=rvts2>SQL&gt; alter table scott.dept enable row movement;
</span>

<span class=rvts2>Table altered.

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; flashback table scott.dept to timestamp to_timestamp('2017-12-14 16:20:00','yyyy-mm-dd hh24:mi:ss');
F</span>

<span class=rvts2>Flashback complete.
S</span>

<span class=rvts2>SQL&gt; select * from scott.dept;
D</span>

<span class=rvts2>DEPTNO DNAME LOC
</span>

<span class=rvts2>---------- -------------- -------------</span>

<span class=rvts2>10 ACCOUNTING NEW YORK
</span>

<span class=rvts2>20 RESEARCH DALLAS
</span>

<span class=rvts2>30 SALES CHICAGO
</span>

<span class=rvts2>40 OPERATIONS BOSTON &nbsp; &nbsp;
S</span>

<span class=rvts2>SQL&gt; alter table scott.dept disable row movement;
</span>

<span class=rvts2>Table altered.</span>

![复制代码]((无标题).files/img6.jpg)

<span class=rvts3>(3)&#38378;&#22238;DROP(drop table)</span>

<span class=rvts2>&#24403;&#19968;&#20010;&#34920;&#34987;drop&#25481;&#65292;&#34920;&#20250;&#34987;&#25918;&#20837;recyclebin&#22238;&#25910;&#31449;&#65292;&#21487;&#36890;&#36807;&#22238;&#25910;&#31449;&#20570;&#34920;&#30340;&#38378;&#22238;&#12290;&#34920;&#19978;&#30340;&#32034;&#24341;&#12289;&#32422;&#26463;&#31561;&#21516;&#26679;&#20250;&#34987;&#24674;&#22797;</span>

<span class=rvts2>&#19981;&#25903;&#25345;sys/system&#29992;&#25143;&#34920;&#31354;&#38388;&#23545;&#35937;&#65292;&#21487;&#36890;&#36807;alter system set recyclebin=off;&#20851;&#38381;&#22238;&#25910;&#31449;&#21151;&#33021;</span>

<span class=rvts2>&#38378;&#22238;DROP&#31034;&#20363;&#65306;</span>

![复制代码]((无标题).files/img7.jpg)

<span class=rvts4>SQL&gt;</span><span class=rvts2> select * from t ;

</span>

<span class=rvts2>
I</span>

<span class=rvts2>ID NAME
</span>

<span class=rvts2>---------- ---------------------------------------</span>

<span class=rvts2>1</span>

<span class=rvts2>2</span>

<span class=rvts2>3</span>

<span class=rvts2>4</span>

<span class=rvts2>30</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; drop table t;

</span>

<span class=rvts2>
</span>

<span class=rvts2>Table dropped.

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; show recyclebin;
O</span>

<span class=rvts2>ORIGINAL NAME RECYCLEBIN NAME OBJECT TYPE DROP TIME
</span>

<span class=rvts2>---------------- ------------------------------ ------------ -------------------
T</span>

<span class=rvts2>T BIN$YEh2QcvZdJLgUxyAgQpnVQ==$0 TABLE 2017-12-14:15:02:06
S</span>

<span class=rvts2>SQL&gt; flashback table t to before drop;

</span>

<span class=rvts2>
F</span>

<span class=rvts2>Flashback complete.

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; select * from t;

</span>

<span class=rvts2>
I</span>

<span class=rvts2>ID NAME
</span>

<span class=rvts2>---------- -------------------------------------</span>

<span class=rvts2>1</span>

<span class=rvts2>2</span>

<span class=rvts2>3</span>

<span class=rvts2>4</span>

<span class=rvts2>30</span>

![复制代码]((无标题).files/img8.jpg)

<span class=rvts2>&#22791;&#27880;&#65306;&#21363;&#20351;&#19981;&#24320;&#22987;flashback&#65292;&#21482;&#35201;&#24320;&#21551;&#20102;recyclebin&#65292;&#37027;&#20040;&#23601;&#21487;&#20197;&#38378;&#22238;DROP&#34920;&#12290;</span>

<span class=rvts2>&#20294;&#22914;&#26524;&#36830;&#32493;&#35206;&#30422;&#65292;&#23601;&#38656;&#35201;&#25351;&#23450;&#24674;&#22797;&#30340;&#34920;&#21517;&#65292;&#22914;&#26524;&#24050;&#32463;&#23384;&#22312;&#34920;&#65292;&#21017;&#38656;&#35201;&#24674;&#22797;&#37325;&#21629;&#21517;&#12290;</span>

![复制代码]((无标题).files/img9.jpg)

<span class=rvts4>SQL&gt;</span><span class=rvts2> show recyclebin;
O</span>

<span class=rvts2>ORIGINAL NAME RECYCLEBIN NAME OBJECT TYPE DROP TIME
</span>

<span class=rvts2>---------------- ------------------------------ ------------ -------------------
T</span>

<span class=rvts2>T BIN$YEh2QcvddJLgUxyAgQpnVQ==$0 TABLE 2017-12-14:15:07:54
T</span>

<span class=rvts2>T BIN$YEh2QcvcdJLgUxyAgQpnVQ==$0 TABLE 2017-12-14:15:07:27
S</span>

<span class=rvts2>SQL&gt; flashback table "BIN$YEh2QcvcdJLgUxyAgQpnVQ==$0" to before drop ;
F</span>

<span class=rvts2>Flashback complete.
S</span>

<span class=rvts2>SQL&gt; show recyclebin;
O</span>

<span class=rvts2>ORIGINAL NAME RECYCLEBIN NAME OBJECT TYPE DROP TIME
</span>

<span class=rvts2>---------------- ------------------------------ ------------ -------------------
T</span>

<span class=rvts2>T BIN$YEh2QcvddJLgUxyAgQpnVQ==$0 TABLE 2017-12-14:15:07:54
S</span>

<span class=rvts2>SQL&gt; flashback table t to before drop rename to tt;
F</span>

<span class=rvts2>Flashback complete.</span>

![复制代码]((无标题).files/img10.jpg)

<span class=rvts3>(4)&#38378;&#22238;&#25968;&#25454;&#24211;(truncate/&#22810;&#34920;&#25968;&#25454;&#21464;&#26356;)</span>

<span class=rvts2>&#25968;&#25454;&#24211;&#38378;&#22238;&#24517;&#39035;&#22312;mounted&#29366;&#24577;&#19979;&#36827;&#34892;&#65292;&#22522;&#20110;&#24555;&#29031;&#30340;&#21487;&#20197;&#20877;open&#19979;&#36827;&#34892;&#38378;&#22238;&#24211;</span>

<span class=rvts2>&#38378;&#22238;&#25968;&#25454;&#24211;&#20027;&#35201;&#26159;&#23558;&#25968;&#25454;&#24211;&#36824;&#21407;&#20540;&#36807;&#21435;&#30340;&#26576;&#20010;&#26102;&#38388;&#28857;&#25110;SCN&#65292;&#29992;&#20110;&#25968;&#25454;&#24211;&#20986;&#29616;&#36923;&#36753;&#38169;&#35823;&#26102;&#65292;&#38656;&#35201;open database resetlogs</span>

<span class=rvts3>a.&#20840;&#24211;&#38378;&#22238;</span>

<span class=rvts2>&#25968;&#25454;&#24211;&#38378;&#22238;&#31034;&#20363;</span>

![复制代码]((无标题).files/img11.jpg)

<span class=rvts4>SQL&gt;</span><span class=rvts2> select * from scott.EMP;

</span>

<span class=rvts2>
E</span>

<span class=rvts2>EMPNO ENAME JOB MGR HIREDATE SAL COMM DEPTNO
</span>

<span class=rvts2>---------- ---------- --------- ---------- ------------------- ---------- ---------- ----------</span>

<span class=rvts2>7369 SMITH CLERK 7902 1980-12-17 00:00:00 800 20</span>

<span class=rvts2>7499 ALLEN SALESMAN 7698 1981-02-20 00:00:00 1600 300 30</span>

<span class=rvts2>7521 WARD SALESMAN 7698 1981-02-22 00:00:00 1250 500 30</span>

<span class=rvts2>7566 JONES MANAGER 7839 1981-04-02 00:00:00 2975 20</span>

<span class=rvts2>7654 MARTIN SALESMAN 7698 1981-09-28 00:00:00 1250 1400 30</span>

<span class=rvts2>7698 BLAKE MANAGER 7839 1981-05-01 00:00:00 2850 30</span>

<span class=rvts2>7782 CLARK MANAGER 7839 1981-06-09 00:00:00 2450 10</span>

<span class=rvts2>7788 SCOTT ANALYST 7566 1987-04-19 00:00:00 3000 20</span>

<span class=rvts2>7839 KING PRESIDENT 1981-11-17 00:00:00 5000 10</span>

<span class=rvts2>7844 TURNER SALESMAN 7698 1981-09-08 00:00:00 1500 0 30</span>

<span class=rvts2>7876 ADAMS CLERK 7788 1987-05-23 00:00:00 1100 20</span>

<span class=rvts2>7900 JAMES CLERK 7698 1981-12-03 00:00:00 950 30</span>

<span class=rvts2>7902 FORD ANALYST 7566 1981-12-03 00:00:00 3000 20</span>

<span class=rvts2>7934 MILLER CLERK 7782 1982-01-23 00:00:00 1300 10</span>

<span class=rvts2>
</span>

<span class=rvts2>14 rows selected.

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; truncate table scott.EMP;

</span>

<span class=rvts2>
</span>

<span class=rvts2>Table truncated.
S</span>

<span class=rvts2>SQL&gt; shutdown immediate;
</span>

<span class=rvts2>Database closed.
</span>

<span class=rvts2>Database dismounted.
O</span>

<span class=rvts2>ORACLE instance shut down.
S</span>

<span class=rvts2>SQL&gt; startup mount;
O</span>

<span class=rvts2>ORACLE instance started.

</span>

<span class=rvts2>
T</span>

<span class=rvts2>Total System Global Area 9.4067E+10 bytes
F</span>

<span class=rvts2>Fixed Size 2263936 bytes
V</span>

<span class=rvts2>Variable Size 9395242112 bytes
</span>

<span class=rvts2>Database Buffers 8.4557E+10 bytes
R</span>

<span class=rvts2>Redo Buffers 112766976 bytes
</span>

<span class=rvts2>Database mounted.
S</span>

<span class=rvts2>SQL&gt; flashback database to timestamp to_timestamp('2017-12-14 14:12:46','yyyy-mm-dd HH24:MI:SS');

</span>

<span class=rvts2>
F</span>

<span class=rvts2>Flashback complete.
S</span>

<span class=rvts2>SQL&gt; alter database open resetlogs;

</span>

<span class=rvts2>
</span>

<span class=rvts2>Database altered.

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; select * from scott.emp;

</span>

<span class=rvts2>
E</span>

<span class=rvts2>EMPNO ENAME JOB MGR HIREDATE SAL COMM DEPTNO
</span>

<span class=rvts2>---------- ---------- --------- ---------- ------------------- ---------- ---------- ----------</span>

<span class=rvts2>7369 SMITH CLERK 7902 1980-12-17 00:00:00 800 20</span>

<span class=rvts2>7499 ALLEN SALESMAN 7698 1981-02-20 00:00:00 1600 300 30</span>

<span class=rvts2>7521 WARD SALESMAN 7698 1981-02-22 00:00:00 1250 500 30</span>

<span class=rvts2>7566 JONES MANAGER 7839 1981-04-02 00:00:00 2975 20</span>

<span class=rvts2>7654 MARTIN SALESMAN 7698 1981-09-28 00:00:00 1250 1400 30</span>

<span class=rvts2>7698 BLAKE MANAGER 7839 1981-05-01 00:00:00 2850 30</span>

<span class=rvts2>7782 CLARK MANAGER 7839 1981-06-09 00:00:00 2450 10</span>

<span class=rvts2>7788 SCOTT ANALYST 7566 1987-04-19 00:00:00 3000 20</span>

<span class=rvts2>7839 KING PRESIDENT 1981-11-17 00:00:00 5000 10</span>

<span class=rvts2>7844 TURNER SALESMAN 7698 1981-09-08 00:00:00 1500 0 30</span>

<span class=rvts2>7876 ADAMS CLERK 7788 1987-05-23 00:00:00 1100 20</span>

<span class=rvts2>7900 JAMES CLERK 7698 1981-12-03 00:00:00 950 30</span>

<span class=rvts2>7902 FORD ANALYST 7566 1981-12-03 00:00:00 3000 20</span>

<span class=rvts2>7934 MILLER CLERK 7782 1982-01-23 00:00:00 1300 10</span>

<span class=rvts2>
</span>

<span class=rvts2>14 rows selected.</span>

![复制代码]((无标题).files/img12.jpg)

<span class=rvts3>b.&#24555;&#29031;&#38378;&#22238;</span>

<span class=rvts2>&nbsp;&#38024;&#23545;&#20027;&#24211;&#21644;&#22791;&#24211;&#37117;&#21487;&#20197;&#21019;&#24314;&#38378;&#22238;&#24555;&#29031;&#28857;&#65292;&#28982;&#21518;&#24674;&#22797;&#21040;&#25351;&#23450;&#30340;&#24555;&#29031;&#28857;&#65292;&#20294;&#20027;&#24211;&#19968;&#26086;&#24674;&#22797;&#21040;&#24555;&#29031;&#28857;&#65292;&#22791;&#24211;&#30340;&#21516;&#27493;&#21017;&#38656;&#35201;&#37325;&#26032;&#21516;&#27493;</span>

![复制代码]((无标题).files/img13.jpg)

<span class=rvts4>SQL&gt;</span><span class=rvts2> select * from scott.dept;

</span>

<span class=rvts2>
</span>

<span class=rvts2> &nbsp; &nbsp;DEPTNO DNAME &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LOC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ADDR
</span>

<span class=rvts2>---------- -------------- ------------- ------------------------------</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;10 ACCOUNTING &nbsp; &nbsp; NEW YORK
 </span>

<span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;20 RESEARCH &nbsp; &nbsp; &nbsp; DALLAS
 </span>

<span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;30 SALES &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CHICAGO
 </span>

<span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;
S</span>

<span class=rvts2>SQL&gt; create restore point before_201712151111 guarantee flashback database;
</span>

<span class=rvts2>Restore point created.

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; create table scott.t as select * from scott.dept;
</span>

<span class=rvts2>Table created.

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; truncate table scott.t;
</span>

<span class=rvts2>Table truncated.
S</span>

<span class=rvts2>SQL&gt; shutdown immediate;
</span>

<span class=rvts2>Database closed.
</span>

<span class=rvts2>Database dismounted.
O</span>

<span class=rvts2>ORACLE instance shut down.
S</span>

<span class=rvts2>SQL&gt; startup mount;
O</span>

<span class=rvts2>ORACLE instance started.

</span>

<span class=rvts2>
T</span>

<span class=rvts2>Total System Global Area 9.4067E+10 bytes
F</span>

<span class=rvts2>Fixed Size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2263936 bytes
V</span>

<span class=rvts2>Variable Size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9663677568 bytes
</span>

<span class=rvts2>Database Buffers &nbsp; &nbsp; &nbsp; &nbsp; 8.4289E+10 bytes
R</span>

<span class=rvts2>Redo Buffers &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;112766976 bytes
</span>

<span class=rvts2>Database mounted.
S</span>

<span class=rvts2>SQL&gt; flashback database to restore point before_201712151111;
F</span>

<span class=rvts2>Flashback complete.
S</span>

<span class=rvts2>SQL&gt; alter database open resetlogs;
</span>

<span class=rvts2>Database altered.

</span>

<span class=rvts2>
&#65533;</span>

<span class=rvts2>&#27492;&#26102;&#20027;&#24211;scott.t&#24050;&#19981;&#23384;&#22312;&#65306;
S</span>

<span class=rvts2>SQL&gt; select * from scott.t;
</span>

<span class=rvts2>select * from scott.t
 </span>

<span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*
E</span>

<span class=rvts2>ERROR at line 1:
O</span>

<span class=rvts2>ORA-00942: table or view does not exist
&#65533;</span>

<span class=rvts2>&#27492;&#26102;&#20174;&#24211;&#30340;scott.&#20381;&#26087;&#23384;&#22312;&#65292;&#20027;&#22791;&#21516;&#27493;&#32456;&#27490;
&#65533;</span>

<span class=rvts2>&#35299;&#20915;&#26041;&#26696;&#65306;&#22312;&#20027;&#24211;&#21019;&#24314;&#24555;&#29031;&#26102;&#38388;&#28857;&#65292;&#20174;&#24211;&#33258;&#21160;&#20572;&#27490;&#24212;&#29992;&#26085;&#24535;&#65292;&#31561;&#20027;&#24211;&#38378;&#22238;&#21518;&#65292;&#37325;&#26032;&#24212;&#29992;&#26085;&#24535;&#21363;&#21487;&#12290;
&#65533;</span>

<span class=rvts2>&#22914;&#26524;&#24050;&#32463;&#20570;&#20102;&#19978;&#36848;&#25805;&#20316;&#65292;&#20174;&#24211;&#21487;&#20197;&#36873;&#25321;&#37325;&#24314;
</span>

<span class=rvts2>ALTER DATABASE REGISTER LOGFILE '/xx/xx/archive.dbf';</span>

![复制代码]((无标题).files/img14.jpg)

<span class=rvts3>&nbsp;c.&#38378;&#22238;snapshot standby</span>

<span class=rvts2>&#27492;&#21151;&#33021;&#22312;11GR2&#38750;&#24120;&#23454;&#29992;&#65292;&#21487;&#33258;&#21160;&#21019;&#24314;&#38378;&#22238;&#28857;&#12289;&#24320;&#21551;&#38378;&#22238;&#26085;&#24535;&#65292;&#21487;&#23436;&#25104;&#32447;&#19978;&#25968;&#25454;&#27979;&#35797;&#21518;&#65292;&#28982;&#21518;&#20570;&#25968;&#25454;&#24211;&#38378;&#22238;&#24674;&#22797;&#20027;&#22791;&#20851;&#31995;</span>

![复制代码]((无标题).files/img15.jpg)

<span class=rvts4>select</span><span class=rvts2> scn, STORAGE_SIZE ,to_char(time,'yyyy-mm-dd hh24:mi:ss') time,NAME from v$restore_point;
</span>

<span class=rvts2>select database_role,open_mode,db_unique_name,flashback_on from v$database;

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; set line 200;
S</span>

<span class=rvts2>SQL&gt; set pagesize 2000;
S</span>

<span class=rvts2>SQL&gt; select database_role,open_mode,db_unique_name,flashback_on from v$database;

</span>

<span class=rvts2>
D</span>

<span class=rvts2>DATABASE_ROLE &nbsp; &nbsp;OPEN_MODE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DB_UNIQUE_NAME &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FLASHBACK_ON
</span>

<span class=rvts2>---------------- -------------------- ------------------------------ ------------------
P</span>

<span class=rvts2>PHYSICAL STANDBY READ ONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;testdbms &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NO

</span>

<span class=rvts2>
</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; ALTER DATABASE CONVERT TO SNAPSHOT STANDBY; &nbsp;

</span>

<span class=rvts2>
</span>

<span class=rvts2>Database altered.

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; select database_role,open_mode,db_unique_name,flashback_on from v$database;

</span>

<span class=rvts2>
D</span>

<span class=rvts2>DATABASE_ROLE &nbsp; &nbsp;OPEN_MODE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DB_UNIQUE_NAME &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FLASHBACK_ON
</span>

<span class=rvts2>---------------- -------------------- ------------------------------ ------------------
S</span>

<span class=rvts2>SNAPSHOT STANDBY MOUNTED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;testdbms &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RESTORE POINT ONLY</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; alter database open;

</span>

<span class=rvts2>
</span>

<span class=rvts2>Database altered.

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; select open_mode from v$database;

</span>

<span class=rvts2>
O</span>

<span class=rvts2>OPEN_MODE
</span>

<span class=rvts2>--------------------</span>

<span class=rvts2>READ WRITE

</span>

<span class=rvts2>
</span>

<span class=rvts2>
&#65533;</span>

<span class=rvts2>&#27492;&#26102;&#22791;&#24211;&#25805;&#20316;&#65306;
S</span>

<span class=rvts2>SQL&gt; select * from scott.emp;

</span>

<span class=rvts2>
</span>

<span class=rvts2> &nbsp; &nbsp; EMPNO ENAME &nbsp; &nbsp; &nbsp;JOB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;MGR HIREDATE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SAL &nbsp; &nbsp; &nbsp; COMM &nbsp; &nbsp; DEPTNO
</span>

<span class=rvts2>---------- ---------- --------- ---------- ------------------- ---------- ---------- ----------</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7369 SMITH &nbsp; &nbsp; &nbsp;CLERK &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7902 1980-12-17 00:00:00 &nbsp; &nbsp; &nbsp; &nbsp;800 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7499 ALLEN &nbsp; &nbsp; &nbsp;SALESMAN &nbsp; &nbsp; &nbsp; &nbsp;7698 1981-02-20 00:00:00 &nbsp; &nbsp; &nbsp; 1600 &nbsp; &nbsp; &nbsp; &nbsp;300 &nbsp; &nbsp; &nbsp; &nbsp; 30</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7521 WARD &nbsp; &nbsp; &nbsp; SALESMAN &nbsp; &nbsp; &nbsp; &nbsp;7698 1981-02-22 00:00:00 &nbsp; &nbsp; &nbsp; 1250 &nbsp; &nbsp; &nbsp; &nbsp;500 &nbsp; &nbsp; &nbsp; &nbsp; 30</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7566 JONES &nbsp; &nbsp; &nbsp;MANAGER &nbsp; &nbsp; &nbsp; &nbsp; 7839 1981-04-02 00:00:00 &nbsp; &nbsp; &nbsp; 2975 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7654 MARTIN &nbsp; &nbsp; SALESMAN &nbsp; &nbsp; &nbsp; &nbsp;7698 1981-09-28 00:00:00 &nbsp; &nbsp; &nbsp; 1250 &nbsp; &nbsp; &nbsp; 1400 &nbsp; &nbsp; &nbsp; &nbsp; 30</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7698 BLAKE &nbsp; &nbsp; &nbsp;MANAGER &nbsp; &nbsp; &nbsp; &nbsp; 7839 1981-05-01 00:00:00 &nbsp; &nbsp; &nbsp; 2850 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;30</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7782 CLARK &nbsp; &nbsp; &nbsp;MANAGER &nbsp; &nbsp; &nbsp; &nbsp; 7839 1981-06-09 00:00:00 &nbsp; &nbsp; &nbsp; 2450 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7788 SCOTT &nbsp; &nbsp; &nbsp;ANALYST &nbsp; &nbsp; &nbsp; &nbsp; 7566 1987-04-19 00:00:00 &nbsp; &nbsp; &nbsp; 3000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7839 KING &nbsp; &nbsp; &nbsp; PRESIDENT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1981-11-17 00:00:00 &nbsp; &nbsp; &nbsp; 5000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7844 TURNER &nbsp; &nbsp; SALESMAN &nbsp; &nbsp; &nbsp; &nbsp;7698 1981-09-08 00:00:00 &nbsp; &nbsp; &nbsp; 1500 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp; 30</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7876 ADAMS &nbsp; &nbsp; &nbsp;CLERK &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7788 1987-05-23 00:00:00 &nbsp; &nbsp; &nbsp; 1100 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7900 JAMES &nbsp; &nbsp; &nbsp;CLERK &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7698 1981-12-03 00:00:00 &nbsp; &nbsp; &nbsp; &nbsp;950 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;30</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7902 FORD &nbsp; &nbsp; &nbsp; ANALYST &nbsp; &nbsp; &nbsp; &nbsp; 7566 1981-12-03 00:00:00 &nbsp; &nbsp; &nbsp; 3000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7934 MILLER &nbsp; &nbsp; CLERK &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7782 1982-01-23 00:00:00 &nbsp; &nbsp; &nbsp; 1300 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10</span>

<span class=rvts2>
</span>

<span class=rvts2>14 rows selected.

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; truncate table scott.emp;

</span>

<span class=rvts2>
</span>

<span class=rvts2>Table truncated.

</span>

<span class=rvts2>
&#65533;</span>

<span class=rvts2>&#20027;&#24211;&#25805;&#20316;&#65306;
S</span>

<span class=rvts2>SQL&gt; create table scott.t as select * from scott.dept;

</span>

<span class=rvts2>
</span>

<span class=rvts2>Table created.

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; select * from scott.t;

</span>

<span class=rvts2>
</span>

<span class=rvts2> &nbsp; &nbsp;DEPTNO DNAME &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LOC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ADDR
</span>

<span class=rvts2>---------- -------------- ------------- ------------------------------</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;10 ACCOUNTING &nbsp; &nbsp; NEW YORK
 </span>

<span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;20 RESEARCH &nbsp; &nbsp; &nbsp; DALLAS
 </span>

<span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;30 SALES &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CHICAGO

</span>

<span class=rvts2>
&#65533;</span>

<span class=rvts2>&#22791;&#24211;&#24674;&#22797;&#21040;&#29289;&#29702;standby
S</span>

<span class=rvts2>SQL&gt; shutdown immediate;
</span>

<span class=rvts2>Database closed.
</span>

<span class=rvts2>Database dismounted.
O</span>

<span class=rvts2>ORACLE instance shut down.
S</span>

<span class=rvts2>SQL&gt; startup mount;
O</span>

<span class=rvts2>ORACLE instance started.

</span>

<span class=rvts2>
T</span>

<span class=rvts2>Total System Global Area 9.4067E+10 bytes
F</span>

<span class=rvts2>Fixed Size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2263936 bytes
V</span>

<span class=rvts2>Variable Size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9663677568 bytes
</span>

<span class=rvts2>Database Buffers &nbsp; &nbsp; &nbsp; &nbsp; 8.4289E+10 bytes
R</span>

<span class=rvts2>Redo Buffers &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;112766976 bytes
</span>

<span class=rvts2>Database mounted.
S</span>

<span class=rvts2>SQL&gt; ALTER DATABASE CONVERT TO PHYSICAL STANDBY; 

</span>

<span class=rvts2>
</span>

<span class=rvts2>Database altered.
S</span>

<span class=rvts2>SQL&gt; shutdown immediate;
O</span>

<span class=rvts2>ORA-01507: database not mounted

</span>

<span class=rvts2>
</span>

<span class=rvts2>
O</span>

<span class=rvts2>ORACLE instance shut down.
S</span>

<span class=rvts2>SQL&gt; startup ;
O</span>

<span class=rvts2>ORACLE instance started.

</span>

<span class=rvts2>
T</span>

<span class=rvts2>Total System Global Area 9.4067E+10 bytes
F</span>

<span class=rvts2>Fixed Size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2263936 bytes
V</span>

<span class=rvts2>Variable Size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9663677568 bytes
</span>

<span class=rvts2>Database Buffers &nbsp; &nbsp; &nbsp; &nbsp; 8.4289E+10 bytes
R</span>

<span class=rvts2>Redo Buffers &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;112766976 bytes
</span>

<span class=rvts2>Database mounted.
</span>

<span class=rvts2>Database opened.

</span>

<span class=rvts2>
#</span>

<span class=rvts2>##&#27492;&#26102;&#22791;&#24211;&#30340;&#25968;&#25454;&#24050;&#32463;&#24674;&#22797;&#21040;&#36716;&#21464;snapshot standby&#26102;&#38388;&#28857;
S</span>

<span class=rvts2>SQL&gt; select database_role,open_mode,db_unique_name,flashback_on from v$database;

</span>

<span class=rvts2>
D</span>

<span class=rvts2>DATABASE_ROLE &nbsp; &nbsp;OPEN_MODE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DB_UNIQUE_NAME &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FLASHBACK_ON
</span>

<span class=rvts2>---------------- -------------------- ------------------------------ ------------------
P</span>

<span class=rvts2>PHYSICAL STANDBY READ ONLY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;testdbms &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NO

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; &nbsp;select * from scott.emp;

</span>

<span class=rvts2>
</span>

<span class=rvts2> &nbsp; &nbsp; EMPNO ENAME &nbsp; &nbsp; &nbsp;JOB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;MGR HIREDATE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SAL &nbsp; &nbsp; &nbsp; COMM &nbsp; &nbsp; DEPTNO
</span>

<span class=rvts2>---------- ---------- --------- ---------- ------------------- ---------- ---------- ----------</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7369 SMITH &nbsp; &nbsp; &nbsp;CLERK &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7902 1980-12-17 00:00:00 &nbsp; &nbsp; &nbsp; &nbsp;800 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7499 ALLEN &nbsp; &nbsp; &nbsp;SALESMAN &nbsp; &nbsp; &nbsp; &nbsp;7698 1981-02-20 00:00:00 &nbsp; &nbsp; &nbsp; 1600 &nbsp; &nbsp; &nbsp; &nbsp;300 &nbsp; &nbsp; &nbsp; &nbsp; 30</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7521 WARD &nbsp; &nbsp; &nbsp; SALESMAN &nbsp; &nbsp; &nbsp; &nbsp;7698 1981-02-22 00:00:00 &nbsp; &nbsp; &nbsp; 1250 &nbsp; &nbsp; &nbsp; &nbsp;500 &nbsp; &nbsp; &nbsp; &nbsp; 30</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7566 JONES &nbsp; &nbsp; &nbsp;MANAGER &nbsp; &nbsp; &nbsp; &nbsp; 7839 1981-04-02 00:00:00 &nbsp; &nbsp; &nbsp; 2975 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7654 MARTIN &nbsp; &nbsp; SALESMAN &nbsp; &nbsp; &nbsp; &nbsp;7698 1981-09-28 00:00:00 &nbsp; &nbsp; &nbsp; 1250 &nbsp; &nbsp; &nbsp; 1400 &nbsp; &nbsp; &nbsp; &nbsp; 30</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7698 BLAKE &nbsp; &nbsp; &nbsp;MANAGER &nbsp; &nbsp; &nbsp; &nbsp; 7839 1981-05-01 00:00:00 &nbsp; &nbsp; &nbsp; 2850 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;30</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7782 CLARK &nbsp; &nbsp; &nbsp;MANAGER &nbsp; &nbsp; &nbsp; &nbsp; 7839 1981-06-09 00:00:00 &nbsp; &nbsp; &nbsp; 2450 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7788 SCOTT &nbsp; &nbsp; &nbsp;ANALYST &nbsp; &nbsp; &nbsp; &nbsp; 7566 1987-04-19 00:00:00 &nbsp; &nbsp; &nbsp; 3000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7839 KING &nbsp; &nbsp; &nbsp; PRESIDENT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1981-11-17 00:00:00 &nbsp; &nbsp; &nbsp; 5000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7844 TURNER &nbsp; &nbsp; SALESMAN &nbsp; &nbsp; &nbsp; &nbsp;7698 1981-09-08 00:00:00 &nbsp; &nbsp; &nbsp; 1500 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp; 30</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7876 ADAMS &nbsp; &nbsp; &nbsp;CLERK &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7788 1987-05-23 00:00:00 &nbsp; &nbsp; &nbsp; 1100 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7900 JAMES &nbsp; &nbsp; &nbsp;CLERK &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7698 1981-12-03 00:00:00 &nbsp; &nbsp; &nbsp; &nbsp;950 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;30</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7902 FORD &nbsp; &nbsp; &nbsp; ANALYST &nbsp; &nbsp; &nbsp; &nbsp; 7566 1981-12-03 00:00:00 &nbsp; &nbsp; &nbsp; 3000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp;7934 MILLER &nbsp; &nbsp; CLERK &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7782 1982-01-23 00:00:00 &nbsp; &nbsp; &nbsp; 1300 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10</span>

<span class=rvts2>
</span>

<span class=rvts2>14 rows selected.

</span>

<span class=rvts2>
</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; alter database recover managed standby database using current logfile disconnect;

</span>

<span class=rvts2>
</span>

<span class=rvts2>Database altered.

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SQL&gt; select * from scott.t;

</span>

<span class=rvts2>
</span>

<span class=rvts2> &nbsp; &nbsp;DEPTNO DNAME &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LOC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ADDR
</span>

<span class=rvts2>---------- -------------- ------------- ------------------------------</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;10 ACCOUNTING &nbsp; &nbsp; NEW YORK
 </span>

<span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;20 RESEARCH &nbsp; &nbsp; &nbsp; DALLAS
 </span>

<span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;30 SALES &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CHICAGO

</span>

<span class=rvts2>
</span>

<span class=rvts2> &nbsp; &nbsp; &nbsp; &nbsp;
S</span>

<span class=rvts2>SQL&gt; &nbsp;select database_role,open_mode,db_unique_name,flashback_on from v$database;

</span>

<span class=rvts2>
D</span>

<span class=rvts2>DATABASE_ROLE &nbsp; &nbsp;OPEN_MODE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DB_UNIQUE_NAME &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FLASHBACK_ON
</span>

<span class=rvts2>---------------- -------------------- ------------------------------ ------------------
P</span>

<span class=rvts2>PHYSICAL STANDBY READ ONLY WITH APPLY testdbms &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NO
 </span>

<span class=rvts2>
</span>

![复制代码]((无标题).files/img16.jpg)

<span class=rvts3>(5)&#38378;&#22238;&#24402;&#26723;(&#22686;&#21152;&#12289;&#20462;&#25913;&#12289;&#37325;&#21629;&#21517;&#12289;&#21024;&#38500;&#34920;&#30340;&#21015;&#12289;truncate&#34920;&#12289;&#20462;&#25913;&#34920;&#30340;&#32422;&#26463;&#12289;&#20197;&#21450;&#20462;&#25913;&#20998;&#21306;&#34920;&#30340;&#20998;&#21306;&#35268;&#33539;)</span>

<span class=rvts2>&nbsp;</span>

<span class=rvts3>3&#12289;&#38378;&#22238;&#27880;&#24847;&#20107;&#39033;</span>

<span class=rvts2>(1)&#25968;&#25454;&#24211;&#38378;&#22238;&#38656;&#35201;&#22312;mounted&#19979;&#36827;&#34892;&#65292;&#24182;&#19988;open&#26102;&#38656;&#35201;&#20351;&#29992;resetlogs</span>

<span class=rvts2>(2)&#38378;&#22238;DROP&#21482;&#33021;&#29992;&#20110;&#38750;&#31995;&#32479;&#34920;&#31354;&#38388;&#21644;&#26412;&#22320;&#31649;&#29702;&#30340;&#34920;&#31354;&#38388;&#65292;&#22806;&#38190;&#32422;&#26463;&#26080;&#27861;&#24674;&#22797;&#65292;&#23545;&#26041;&#35206;&#30422;&#12289;&#37325;&#21629;&#21517;&#38656;&#27880;&#24847;</span>

<span class=rvts2>(3)&#34920;DROP&#65292;&#23545;&#24212;&#30340;&#29289;&#21270;&#35270;&#22270;&#20250;&#34987;&#24443;&#24213;&#21024;&#38500;&#65292;&#29289;&#21270;&#35270;&#22270;&#19981;&#20250;&#23384;&#25918;&#22312;recyclebin&#37324;</span>

<span class=rvts2>(4)&#38378;&#22238;&#34920;&#65292;&#22914;&#26524;&#22312;&#20570;&#36807;dml&#65292;&#28982;&#21518;&#36827;&#34892;&#20102;&#34920;&#32467;&#26500;&#20462;&#25913;&#12289;truncate&#31561;DDL&#25805;&#20316;&#65292;&#26032;&#22686;/&#21024;&#38500;&#32467;&#26500;&#26080;&#27861;&#20570;&#38378;&#22238;</span>

<span class=rvts2>(5)&#38378;&#22238;&#24402;&#26723;&#65292;&#24517;&#39035;&#22312;assm&#31649;&#29702;tablespace&#21644;undo auto&#31649;&#29702;&#19979;&#36827;&#34892;</span>

<span class=rvts2>(6)&#27880;&#24847;&#38378;&#22238;&#21306;&#31649;&#29702;&#65292;&#38450;&#27490;&#30913;&#30424;&#29190;&#28385;&#65292;&#38378;&#22238;&#21306;&#31354;&#38388;&#19981;&#36275;&#31561;</span>

<span class=rvts2>(7)&#20027;&#24211;&#20570;&#24211;&#30340;&#38378;&#22238;&#65292;&#20250;&#24433;&#21709;&#22791;&#24211;&#65292;&#38656;&#35201;&#37325;&#26032;&#21516;&#27493;</span>

<span class=rvts2>(8)snapshot standby &#19981;&#25903;&#25345;&#26368;&#39640;&#20445;&#25252;&#27169;&#24335;</span>

<span class=rvts3>&#19977;&#12289;&#22791;&#27880;</span>

<span class=rvts3>1&#12289;&#30456;&#20851;&#25968;&#25454;&#23383;&#20856;</span>

<span class=rvts2>V$FLASHBACK_DATABASE_LOG ##&#26597;&#30475;&#25968;&#25454;&#24211;&#21487;&#38378;&#22238;&#30340;&#26102;&#38388;&#28857;/SCN&#31561;&#20449;&#24687;</span>

<span class=rvts2>V$flashback_database_stat ##&#26597;&#30475;&#38378;&#22238;&#26085;&#24535;&#31354;&#38388;&#35760;&#24405;&#20449;&#24687;</span>

<span class=rvts3>2&#12289;&#24120;&#29992;&#26597;&#35810;&#35821;&#21477;</span>

<span class=rvts3>(1)&#26597;&#30475;&#25968;&#25454;&#24211;&#29366;&#24577;</span>

<span class=rvts4>SQL&gt;</span><span class=rvts2> select NAME,OPEN_MODE ,DATABASE_ROLE,CURRENT_SCN,FLASHBACK_ON from v$database;

</span>

<span class=rvts2>
N</span>

<span class=rvts2>NAME OPEN_MODE DATABASE_ROLE CURRENT_SCN FLASHBACK_ON
</span>

<span class=rvts2>------------- -------------------- ---------------- ----------- ------------------
T</span>

<span class=rvts2>TESTDB READ WRITE PRIMARY 16812246 YES</span>

<span class=rvts3>(2)&#33719;&#21462;&#24403;&#21069;&#25968;&#25454;&#24211;&#30340;&#31995;&#32479;&#26102;&#38388;&#21644;SCN</span>

<span class=rvts2>&nbsp;</span>

<span class=rvts4>SQL&gt;</span><span class=rvts2> select to_char(systimestamp,'yyyy-mm-dd HH24:MI:SS') as sysdt , dbms_flashback.get_system_change_number scn from dual;

</span>

<span class=rvts2>
S</span>

<span class=rvts2>SYSDT SCN
</span>

<span class=rvts2>------------------- ----------</span>

<span class=rvts2>2017-12-14 14:28:33 16813234</span>

<span class=rvts3>(3)&#26597;&#30475;&#25968;&#25454;&#24211;&#21487;&#24674;&#22797;&#30340;&#26102;&#38388;&#28857;</span>

<span class=rvts4>SQL&gt;</span><span class=rvts2> select * from V$FLASHBACK_DATABASE_LOG;

</span>

<span class=rvts2>
O</span>

<span class=rvts2>OLDEST_FLASHBACK_SCN OLDEST_FLASHBACK_TI RETENTION_TARGET FLASHBACK_SIZE ESTIMATED_FLASHBACK_SIZE
</span>

<span class=rvts2>-------------------- ------------------- ---------------- -------------- ------------------------</span>

<span class=rvts2>16801523 2017-12-14 11:35:05 4320 104857600 244113408</span>

<span class=rvts3>(4)&#26597;&#30475;&#38378;&#22238;&#26085;&#24535;&#31354;&#38388;&#24773;&#20917;</span>

<span class=rvts4>SQL&gt;</span><span class=rvts2> select * from V$flashback_database_stat;
B</span>

<span class=rvts2>BEGIN_TIME END_TIME FLASHBACK_DATA DB_DATA REDO_DATA ESTIMATED_FLASHBACK_SIZE
</span>

<span class=rvts2>------------------- ------------------- -------------- ---------- ---------- ------------------------</span>

<span class=rvts2>2017-12-14 14:34:53 2017-12-14 14:56:43 1703936 9977856 1487872 0</span>

<span class=rvts3>(5)SCN&#21644;timestamp&#35013;&#25442;&#20851;&#31995;&#26597;&#35810;</span>

<span class=rvts4>select</span><span class=rvts2> scn,to_char(time_dp,'yyyy-mm-dd hh24:mi:ss')from sys.smon_scn_time;</span>

<span class=rvts3>(6)&#26597;&#30475;&#38378;&#22238;restore_point</span>

<span class=rvts4>select</span><span class=rvts2> scn, STORAGE_SIZE ,to_char(time,'yyyy-mm-dd hh24:mi:ss') time,NAME from v$restore_point;</span>

<span class=rvts3>(7)&#38378;&#22238;&#35821;&#21477;</span>

<span class=rvts2>a.&#38378;&#22238;&#25968;&#25454;&#24211;</span>

<span class=rvts2>&#12288;&#12288;FLASHBACK DATABASE TO TIMESTAMP to_timestamp('2017-12-14 14:28:33','yyyy-mm-dd HH24:MI:SS');;</span>

<span class=rvts2>&#12288;&#12288;flashback database to scn 16813234;</span>

<span class=rvts2>b.&#38378;&#22238;DROP</span>

<span class=rvts2>&#20854;&#20013;table_name&#21487;&#20197;&#26159;&#21024;&#38500;&#34920;&#21517;&#31216;&#65292;&#20063;&#21487;&#20197;&#26159;&#21035;&#21517;</span>

<span class=rvts2>&#12288;&#12288;flashback table table_name to before drop;</span>

<span class=rvts2>&#12288;&#12288;flashback table table_name to before drop rename to table_name_new;</span>

<span class=rvts2>c.&#38378;&#22238;&#34920;</span>

<span class=rvts2>&#12288;&#12288;flashback table table_name to scn scn_number;</span>

<span class=rvts2>&#12288;&#12288;flashback table table_name to timestamp to_timestamp('2017-12-14 14:28:33','yyyy-mm-dd hh24:mi:ss');</span>

<span class=rvts2>d.&#38378;&#22238;&#26597;&#35810;</span>

<span class=rvts2>&#12288;&#12288;select * from table_name as of timestamp to_timestamp('2017-12-14 14:28:33','yyyy-mm-dd hh24:mi:ss');</span>

<span class=rvts2>&#12288;&#12288;select * from scott.dept as of scn 16801523;</span>

<span class=rvts2>e.&#38378;&#22238;&#24555;&#29031;</span>

<span class=rvts2>&#12288;&#12288;create restore point before_201712151111 guarantee flashback database;</span>

<span class=rvts2>&#12288;&#12288;flashback database to restore point before_201712151111;</span>

<span class=rvts3>(7)&#38378;&#22238;&#31354;&#38388;&#29190;&#28385;&#38382;&#39064;&#22788;&#29702;</span>

<span class=rvts3>&#35831;&#21442;&#29031;&#25105;&#20043;&#21069;&#30340;&#24494;&#21338;&#65306;http://blog.itpub.net/27067062/viewspace-2129130/</span>

</body></html>